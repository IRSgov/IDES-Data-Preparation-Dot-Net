{"name":"IDES Data Preparation.NET","tagline":"An example of the data preparation process using .NET Framework","body":"### IDES Data Preparation\r\nThe International Data Exchange Service (IDES) is a secure managed file transfer service that allows financial institutions and foreign tax authorities to securely send information on financial accounts held by U.S. taxpayers in accordance with the Foreign Account Tax Compliance Act (FATCA). \r\n\r\nThe IDES Data Preparation.NET project repository demonstrates a working application built using [Microsoft Visual Studio 2013 Community edition](http://www.visualstudio.com/en-us/products/free-developer-offers-vs).  There are many tools available that may produce the same results. The IRS does not endorse any software applications or commercial products.\r\n\r\nThe example explains how to create a new project and use the code to build an application that will create a valid transmission and process notifications through IDES. The project starts with a validated FATCA XML file. The application will digitally sign, encrypt, compress, and archive the data packet into a compliant .ZIP format that is ready for transmission in IDES.\r\n\r\nOpen **Visual Studio**, select **New Project**.\r\n![Image 1](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img1.png)\r\n\r\n#### Create a New Project \r\n![Image 2](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img2.png)\r\nUnder **New Project**, select the settings Visual C#, Windows Desktop and Windows Forms Application. Verify the settings, name and location. Click **OK** to continue.\r\n\r\n#### Adding References\r\n![Image 3](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img3.png)\r\nNext, you will add a reference to the each of the following:\r\n* System.IO.Compression\r\n* System.IO.Compression.FileSystem\r\n* System.Security  \r\nSelect the **Project ** and **Add Reference** from the program menu. The **Reference Manager-SignXML** screen appears. Select the checkbox next to each entry and click **OK**.\r\n\r\n\r\n#### Adding Components\r\n![Image 3](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img4.png)\r\nIn the **Designer Interface**, add the components listed below. The selections are used when you run the application. The figure above shows a sample layout.\r\n\r\n\r\n| Label               | Text          | Button          |\r\n|:-------------------:|:-------------:|:---------------:|\r\n|lblLoadXM            |txtXmlFile     |btnBrowseXml     |\r\n|lblCert              |txtCert        |btnBrowseCert    |\r\n|lblCertPass          |**txtCertPass**    |N/A|\r\n|lblKeyCert           |txtKeyCert     |btnBrowseKeyCert  |\r\n|lblKeyEncryptionCertPassword |txtKeyCertPassword|btnSignXML|\r\n|lblZipFile |txtNotificationZip |btnBrowseNotificationZip|\r\n|lblReceiverCert |txtReceiverCert|btnBrowseRecCert |\r\n|lblRecPass |**txtRecKeyPassword** |btnDecryptZip|\r\n|lblSender  |txtSenderCode  |N/A|\r\n|lblReceiver  |txtReceiverCode  |N/A   |\r\n|lblOutput  |txtNotificationFolder  |btnBrowseOutput   |\r\n|OpenFileDialog  |dlgOpen  |N/A   |\r\n|SaveFileDialog  |dlgSave  |N/A   |\r\n|FolderBrowserDialog  |dlgOpenFolder  | N/A  |\r\n \r\nNote: The **passwordChar **attribute can be set to mask the input for this text box.\r\n\r\n### Create Class Files\r\n\r\n#### Organizing Class Files \r\nThe descriptions of the interface components may be modified to provide more detail.\r\n  \r\n![Image 5](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img5.png)\r\nFigure 5  \r\n  \r\nIn **Solution Explorer**, add a new folder named **Helpers ** that will contain class files or modules for the phase of the application.  \r\n\r\n#### Class File - ExtensionMethods.cs\r\n![Image 6](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img6.png)  \r\nFigure 6  \r\n\r\nIn the **Helpers** folder, create a new class file named **ExtensionMethods.cs**.  \r\n\r\n![Image 7](http://irsgov.github.io/IDES-Data-Preparation-Dot-Net/images/img7.png)  \r\nFigure 7    \r\n\r\nNext, let’s create code used to display error messages and show the file load dialog screens. In the new class **ExtensionMethods.cs** , enter the following:   \r\n```  \r\nusing System;\r\nusing System.Windows.Forms;\r\n\r\nnamespace WindowsFormsApplication1\r\n{\r\n    public static class ExtensionMethods\r\n    {\r\n        public static string ShowDialogWithFilter(this OpenFileDialog dialog, string filter)\r\n        {\r\n            dialog.Filter = filter;\r\n\r\n            if (dialog.ShowDialog() == DialogResult.OK)\r\n            {\r\n                return dialog.FileName;\r\n            }\r\n            return string.Empty;\r\n        }\r\n        public static void DisplayException(this Exception ex, string messageBoxTitle)\r\n        {\r\n            string errorMessage = ex.GetBaseException().Message;\r\n\r\n            if (errorMessage.Contains(\"password\"))\r\n            {\r\n                // certificate password is incorrect\r\n                MessageBox.Show(\"Specified certificate password is incorrect!\", messageBoxTitle, MessageBoxButtons.OK, MessageBoxIcon.Warning);\r\n                return;\r\n            }\r\n            // other error\r\n            MessageBox.Show(errorMessage, messageBoxTitle, MessageBoxButtons.OK, MessageBoxIcon.Warning);\r\n        }\r\n\r\n    }\r\n}\r\n```  \r\n  \r\n  \r\n \r\n\r\n  \r\n\r\n  \r\n  \r\n\r\n\r\n```\r\n$ cd your_repo_root/repo_name\r\n$ git fetch origin\r\n$ git checkout gh-pages\r\n```\r\n\r\n\r\n\r\n\r\n\r\n### Authors and Contributors\r\nYou can @mention a GitHub username to generate a link to their profile. The resulting `<a>` element will link to the contributor's GitHub Profile. For example: In 2007, Chris Wanstrath (@defunkt), PJ Hyett (@pjhyett), and Tom Preston-Werner (@mojombo) founded GitHub.\r\n\r\n### Support or Contact\r\nHaving trouble with Pages? Check out the documentation at https://help.github.com/pages or contact support@github.com and we’ll help you sort it out.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}